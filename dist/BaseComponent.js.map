{"version":3,"file":"BaseComponent.js","sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 084d722e2401c994d7e7","webpack:///external {\"commonjs\":\"dom\",\"commonjs2\":\"dom\",\"amd\":\"dom\",\"root\":\"dom\"}","webpack:///external {\"commonjs\":\"on\",\"commonjs2\":\"on\",\"amd\":\"on\",\"root\":\"on\"}","webpack:////Users/mwilcox/Sites/github/create-element/src/BaseComponent.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"dom\"), require(\"on\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"dom\", \"on\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"BaseComponent\"] = factory(require(\"dom\"), require(\"on\"));\n\telse\n\t\troot[\"BaseComponent\"] = factory(root[\"dom\"], root[\"on\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 084d722e2401c994d7e7","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"dom\",\"commonjs2\":\"dom\",\"amd\":\"dom\",\"root\":\"dom\"}\n// module id = 0\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"on\",\"commonjs2\":\"on\",\"amd\":\"on\",\"root\":\"on\"}\n// module id = 1\n// module chunks = 0","// class/component rules\n// always call super() first in the ctor. This also calls the extended class' ctor.\n// cannot call NEW on a Component class\n//\n// Classes http://exploringjs.com/es6/ch_classes.html#_the-species-pattern-in-static-methods\n\nconst on = require('on');\nconst dom = require('dom');\n\nclass BaseComponent extends HTMLElement {\n    constructor() {\n        super();\n        this._uid = dom.uid(this.localName);\n        privates[this._uid] = {DOMSTATE: 'created'};\n        privates[this._uid].handleList = [];\n\n        plugin('init', this);\n\n    }\n    \n    connectedCallback() {\n\n        privates[this._uid].DOMSTATE = 'connected';\n        plugin('preConnected', this);\n\n        nextTick(onCheckDomReady.bind(this));\n\n        if (this.connected) {\n            this.connected();\n        }\n        this.fire('connected');\n\n        plugin('postConnected', this);\n    }\n\n    disconnectedCallback() {\n        privates[this._uid].DOMSTATE = 'disconnected';\n        plugin('preDisconnected', this);\n        if (this.disconnected) {\n            this.disconnected();\n        }\n        this.fire('disconnected');\n    }\n\n    attributeChangedCallback(attrName, oldVal, newVal) {\n        console.log(' *** attributeChangedCallback', attrName);\n        plugin('preAttributeChanged', this, attrName, newVal, oldVal);\n        if (this.attributeChanged) {\n            this.attributeChanged(attrName, newVal, oldVal);\n        }\n    }\n\n    destroy() {\n        this.fire('destroy');\n        privates[this._uid].handleList.forEach(function (handle) {\n            handle.remove();\n        });\n        dom.destroy(this);\n    }\n\n    fire(eventName, eventDetail, bubbles) {\n        return on.fire(this, eventName, eventDetail, bubbles);\n    }\n\n    emit(eventName, value) {\n        return on.emit(this, eventName, value);\n    }\n\n    on(node, eventName, selector, callback) {\n        return this.registerHandle(\n            typeof node != 'string' ? // no node is supplied\n                on(node, eventName, selector, callback) :\n                on(this, node, eventName, selector));\n    }\n\n    once(node, eventName, selector, callback) {\n        return this.registerHandle(\n            typeof node != 'string' ? // no node is supplied\n                on.once(node, eventName, selector, callback) :\n                on.once(this, node, eventName, selector, callback));\n    }\n\n    registerHandle(handle) {\n        privates[this._uid].handleList.push(handle);\n        return handle;\n    }\n\n    get DOMSTATE() {\n        return privates[this._uid].DOMSTATE;\n    }\n\n    static clone(template) {\n        if (template.content && template.content.children) {\n            return document.importNode(template.content, true);\n        }\n        var\n            frag = document.createDocumentFragment(),\n            cloneNode = document.createElement('div');\n        cloneNode.innerHTML = template.innerHTML;\n\n        while (cloneNode.children.length) {\n            frag.appendChild(cloneNode.children[0]);\n        }\n        return frag;\n    }\n\n    static addPlugin(plug) {\n        var i, order = plug.order || 100;\n        if (!plugins.length) {\n            plugins.push(plug);\n        }\n        else if (plugins.length === 1) {\n            if (plugins[0].order <= order) {\n                plugins.push(plug);\n            }\n            else {\n                plugins.unshift(plug);\n            }\n        }\n        else if (plugins[0].order > order) {\n            plugins.unshift(plug);\n        }\n        else {\n\n            for (i = 1; i < plugins.length; i++) {\n                if (order === plugins[i - 1].order || (order > plugins[i - 1].order && order < plugins[i].order)) {\n                    plugins.splice(i, 0, plug);\n                    return;\n                }\n            }\n            // was not inserted...\n            plugins.push(plug);\n        }\n    }\n}\n\nlet\n    privates = {},\n    plugins = [];\n\nfunction plugin(method, node, a, b, c) {\n    plugins.forEach(function (plug) {\n        if (plug[method]) {\n            plug[method](node, a, b, c);\n        }\n    });\n}\n\nfunction onCheckDomReady() {\n    if (this.DOMSTATE != 'connected') {\n        return;\n    }\n\n    var\n        count = 0,\n        children = getChildCustomNodes(this),\n        ourDomReady = onDomReady.bind(this);\n\n    function addReady() {\n        count++;\n        if (count == children.length) {\n            ourDomReady();\n        }\n    }\n\n    // If no children, we're good - leaf node. Commence with onDomReady\n    //\n    if (!children.length) {\n        ourDomReady();\n    }\n    else {\n        // else, wait for all children to fire their `ready` events\n        //\n        children.forEach(function (child) {\n            // check if child is already ready\n            if (child.DOMSTATE == 'domready') {\n                addReady();\n            }\n            // if not, wait for event\n            child.on('domready', addReady);\n        });\n    }\n}\n\nfunction onDomReady() {\n    privates[this._uid].DOMSTATE = 'domready';\n    plugin('preDomReady', this);\n    // call this.domReady first, so that the component\n    // can finish initializing before firing any\n    // subsequent events\n    if (this.domReady) {\n        this.domReady();\n        // domReady should only ever fire once\n        this.domReady = function () {\n        };\n    }\n\n    this.fire('domready');\n\n    plugin('postDomReady', this);\n}\n\nfunction getChildCustomNodes(node) {\n    // collect any children that are custom nodes\n    // used to check if their dom is ready before\n    // determining if this is ready\n    var i, nodes = [];\n    for (i = 0; i < node.children.length; i++) {\n        if (node.children[i].nodeName.indexOf('-') > -1) {\n            nodes.push(node.children[i]);\n        }\n    }\n    return nodes;\n}\n\nfunction nextTick(cb) {\n    requestAnimationFrame(cb);\n}\n\nexport default BaseComponent;\n\n\n//////////////////\n// WEBPACK FOOTER\n// /Users/mwilcox/Sites/github/create-element/src/BaseComponent.js\n// module id = 2\n// module chunks = 0"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC9DA;;;;;;ACAA;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;","sourceRoot":""}